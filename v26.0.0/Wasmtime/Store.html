<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Wasmtime::Store
  
    &mdash; Documentation by YARD 0.9.37
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Wasmtime::Store";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (S)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Wasmtime.html" title="Wasmtime (module)">Wasmtime</a></span></span>
     &raquo; 
    <span class="title">Store</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Wasmtime::Store
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Wasmtime::Store</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>ext/src/ruby_api/store.rs</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Represents a WebAssembly store.</p>


  </div>
</div>
<div class="tags">
  

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="https://docs.rs/wasmtime/latest/wasmtime/struct.Store.html" target="_parent" title="Wasmtime&#39;s Rust doc">Wasmtime's Rust doc</a></li>
    
  </ul>

</div>






  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#new-class_method" title="new (class method)">.<strong>new</strong>(engine, data = nil, wasi_ctx: nil, limits: nil)  &#x21d2; Wasmtime::Store </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#data-instance_method" title="#data (instance method)">#<strong>data</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The passed in value in <span class='object_link'><a href="#new-class_method" title="Wasmtime::Store.new (method)">Store.new</a></span>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_fuel-instance_method" title="#get_fuel (instance method)">#<strong>get_fuel</strong>  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the amount of fuel in the <span class='object_link'><a href="" title="Wasmtime::Store (class)">Store</a></span>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#linear_memory_limit_hit%3F-instance_method" title="#linear_memory_limit_hit? (instance method)">#<strong>linear_memory_limit_hit?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns whether the linear memory limit has been hit.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#max_linear_memory_consumed-instance_method" title="#max_linear_memory_consumed (instance method)">#<strong>max_linear_memory_consumed</strong>  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the maximum linear memory consumed.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_epoch_deadline-instance_method" title="#set_epoch_deadline (instance method)">#<strong>set_epoch_deadline</strong>(ticks_beyond_current)  &#x21d2; nil </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Sets the epoch deadline to a certain number of ticks in the future.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_fuel-instance_method" title="#set_fuel (instance method)">#<strong>set_fuel</strong>(fuel)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Sets fuel to the <span class='object_link'><a href="" title="Wasmtime::Store (class)">Store</a></span>.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="new-class_method">
  
    .<strong>new</strong>(engine, data = nil, wasi_ctx: nil, limits: nil)  &#x21d2; <tt><span class='object_link'><a href="" title="Wasmtime::Store (class)">Wasmtime::Store</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_store'>store</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Wasmtime.html" title="Wasmtime (module)">Wasmtime</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="Wasmtime::Store (class)">Store</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Wasmtime.html" title="Wasmtime (module)">Wasmtime</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Engine.html" title="Wasmtime::Engine (class)">Engine</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Engine.html#new-class_method" title="Wasmtime::Engine.new (method)">new</a></span></span><span class='rparen'>)</span></code></pre>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_store'>store</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Wasmtime.html" title="Wasmtime (module)">Wasmtime</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="Wasmtime::Store (class)">Store</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Wasmtime.html" title="Wasmtime (module)">Wasmtime</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Engine.html" title="Wasmtime::Engine (class)">Engine</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Engine.html#new-class_method" title="Wasmtime::Engine.new (method)">new</a></span></span><span class='comma'>,</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>engine</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Engine.html" title="Wasmtime::Engine (class)">Wasmtime::Engine</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The engine for this store.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>data</span>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The data attached to the store. Can be retrieved through <span class='object_link'><a href="#data-instance_method" title="Wasmtime::Store#data (method)">#data</a></span> and Caller#data.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>wasi_ctx</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="WasiCtxBuilder.html" title="Wasmtime::WasiCtxBuilder (class)">Wasmtime::WasiCtxBuilder</a></span></tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>The WASI context to use in this store.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>limits</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>See the <a href="https://docs.rs/wasmtime/latest/wasmtime/struct.StoreLimitsBuilder.html" target="_parent" title="&lt;code&gt;StoreLimitsBuilder&lt;/code&gt;‘s Rust doc"><code>StoreLimitsBuilder</code>‘s Rust doc</a> for detailed description of the different options and the defaults.</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    
    
    
    
    <p class="tag_title">Options Hash (<tt>limits:</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">memory_size</span>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The maximum number of bytes a linear memory can grow to.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">table_elements</span>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The maximum number of elements in a table.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">instances</span>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The maximum number of instances that can be created for a Store.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">tables</span>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The maximum number of tables that can be created for a Store.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">memories</span>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The maximum number of linear memories that can be created for a Store.</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Wasmtime::Store (class)">Wasmtime::Store</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/src/ruby_api/store.rs', line 137</span>

pub fn new(args: &amp;[Value]) -&gt; Result&lt;Self, Error&gt; {
    let args = scan_args::scan_args::&lt;(&amp;Engine,), (Option&lt;Value&gt;,), (), (), _, ()&gt;(args)?;
    let kw = scan_args::get_kwargs::&lt;_, (), (Option&lt;&amp;WasiCtx&gt;, Option&lt;RHash&gt;), ()&gt;(
        args.keywords,
        &amp;[],
        &amp;[*WASI_CTX, *LIMITS],
    )?;

    let (engine,) = args.required;
    let (user_data,) = args.optional;
    let user_data = user_data.unwrap_or_else(|| ().into_value());
    let wasi = kw.optional.0.map(|wasi_ctx| wasi_ctx.get_inner());

    let limiter = match kw.optional.1 {
        None =&gt; StoreLimitsBuilder::new(),
        Some(limits) =&gt; hash_to_store_limits_builder(limits)?,
    }
    .build();
    let limiter = TrackingResourceLimiter::new(limiter);

    let eng = engine.get();
    let store_data = StoreData {
        user_data,
        wasi,
        refs: Default::default(),
        last_error: Default::default(),
        store_limits: limiter,
    };
    let store = Self {
        inner: UnsafeCell::new(StoreImpl::new(eng, store_data)),
    };

    unsafe { &amp;mut *store.inner.get() }.limiter(|data| &amp;mut data.store_limits);

    Ok(store)
}</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="data-instance_method">
  
    #<strong>data</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns The passed in value in <span class='object_link'><a href="#new-class_method" title="Wasmtime::Store.new (method)">new</a></span>.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The passed in value in <span class='object_link'><a href="#new-class_method" title="Wasmtime::Store.new (method)">new</a></span></p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


176
177
178</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/src/ruby_api/store.rs', line 176</span>

pub fn data(&amp;self) -&gt; Value {
    self.context().data().user_data()
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_fuel-instance_method">
  
    #<strong>get_fuel</strong>  &#x21d2; <tt>Integer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the amount of fuel in the <span class='object_link'><a href="" title="Wasmtime::Store (class)">Wasmtime::Store</a></span>.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Error.html" title="Wasmtime::Error (class)">Error</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if fuel consumption is not enabled via Engine#new</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


185
186
187</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/src/ruby_api/store.rs', line 185</span>

pub fn get_fuel(&amp;self) -&gt; Result&lt;u64, Error&gt; {
    self.inner_ref().get_fuel().map_err(|e| error!(&quot;{}&quot;, e))
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="linear_memory_limit_hit?-instance_method">
  
    #<strong>linear_memory_limit_hit?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns whether the linear memory limit has been hit.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


221
222
223</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/src/ruby_api/store.rs', line 221</span>

pub fn linear_memory_limit_hit(&amp;self) -&gt; bool {
    self.context().data().store_limits.linear_memory_limit_hit()
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="max_linear_memory_consumed-instance_method">
  
    #<strong>max_linear_memory_consumed</strong>  &#x21d2; <tt>Integer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the maximum linear memory consumed.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


229
230
231
232
233
234</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/src/ruby_api/store.rs', line 229</span>

pub fn max_linear_memory_consumed(&amp;self) -&gt; usize {
    self.context()
        .data()
        .store_limits
        .max_linear_memory_consumed()
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_epoch_deadline-instance_method">
  
    #<strong>set_epoch_deadline</strong>(ticks_beyond_current)  &#x21d2; <tt>nil</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Sets the epoch deadline to a certain number of ticks in the future.</p>

<p>Raises if there isn’t enough fuel left in the <span class='object_link'><a href="" title="Wasmtime::Store (class)">Wasmtime::Store</a></span>, or when the <span class='object_link'><a href="Engine.html" title="Wasmtime::Engine (class)">Engine</a></span>‘s config does not have fuel enabled.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>ticks_beyond_current</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The number of ticks before this store reaches the deadline.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>nil</tt>)</span>
      
      
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="ttps://docs.rs/wasmtime/latest/wasmtime/struct.Store.html#method.set_epoch_deadline" target="_parent" title="Rust&#39;s doc on +set_epoch_deadline_ for more details.">Rust's doc on +set_epoch_deadline_ for more details.</a></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


212
213
214</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/src/ruby_api/store.rs', line 212</span>

pub fn set_epoch_deadline(&amp;self, ticks_beyond_current: u64) {
    unsafe { &amp;mut *self.inner.get() }.set_epoch_deadline(ticks_beyond_current);
}</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_fuel-instance_method">
  
    #<strong>set_fuel</strong>(fuel)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Sets fuel to the <span class='object_link'><a href="" title="Wasmtime::Store (class)">Wasmtime::Store</a></span>.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>fuel</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The new fuel amount.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Error.html" title="Wasmtime::Error (class)">Error</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if fuel consumption is not enabled via Engine#new</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


194
195
196
197
198
199
200</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'ext/src/ruby_api/store.rs', line 194</span>

pub fn set_fuel(&amp;self, fuel: u64) -&gt; Result&lt;(), Error&gt; {
    unsafe { &amp;mut *self.inner.get() }
        .set_fuel(fuel)
        .map_err(|e| error!(&quot;{}&quot;, e))?;

    Ok(())
}</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Thu Oct 24 17:15:44 2024 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.37 (ruby-3.3.5).
</div>

    </div>
  </body>
</html>